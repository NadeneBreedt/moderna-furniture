<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Moderna Office Furniture</title>

  <!-- Add fix-sticky.js script -->
  <script src="styles/fix-sticky.js"></script>
  
  <!-- Add animations CSS -->
  <link rel="stylesheet" href="styles/animations.css">
  
  <!-- Standardized header loader -->
  <script src="js/header-loader.js"></script>

  <style>
    /* Add styles to prevent header glitching during page loads */
    #my-header {
      opacity: 1;
      transition: opacity 0.2s ease;
      min-height: 60px; /* Reserve space for the header */
    }
    
    #my-header.loading {
      opacity: 0;
    }
    
    /* Apply a transition to the header when it appears */
    header {
      transition: all 0.2s ease;
      will-change: transform;
      transform: translateZ(0);
    }
    
    * {
      margin: 0; 
      padding: 0; 
      box-sizing: border-box;
    }
    
    :root {
      --primary-color: #292524;
      --accent-color: #FFD700;
      --light-gray: #f8f8f8;
      --dark-gray: #444444;
      --border-color: #e7e5e4;
    }
    
    body {
      font-family: "Inter", "Helvetica Neue", Arial, sans-serif;
      background-color: #FFFFFF;
      color: var(--dark-gray);
      line-height: 1.6;
    }
    
    img {
      display: block;
      max-width: 100%;
      height: auto;
    }
    
    a {
      text-decoration: none;
      color: inherit;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 2rem;
    }

    /* Header adjustments to hug edges */
    #my-header .container {
      padding: 0;
      width: 100%;
      max-width: 100%;
    }
    
    header {
      padding: 0 !important;
      width: 100%;
      position: sticky;
      top: 0;
      z-index: 9999;
      background-color: white;
      transition: all 0.2s ease;
      will-change: transform;
      transform: translateZ(0);
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
    }
    
    header .container {
      padding: 0 !important;
      display: flex;
      justify-content: space-between;
      width: 100%;
      max-width: 100%;
    }
    
    .header-logo {
      margin-left: 0 !important;
      padding-left: 0 !important;
    }
    
    .nav-menu {
      margin-right: 0 !important;
      padding-right: 0 !important;
      position: relative;
      right: 0;
    }
    
    /* Force navigation items to the right */
    .nav-links {
      margin-right: 0 !important;
      padding-right: 0 !important;
      display: flex;
      justify-content: flex-end;
    }
    
    nav {
      width: 100%;
      display: flex;
      justify-content: flex-end;
    }
    
    /* End of header adjustments */

    /* Hero Section */
    .hero-banner {
      background-color: white;
      padding: 0;
      margin-bottom: 0;
      border-bottom: 1px solid var(--border-color);
      position: relative;
      overflow: hidden;
      display: flex;
      justify-content: space-between;
      min-height: 650px; /* Increased from 550px */
    }

    .hero-content {
      text-align: left;
      max-width: 800px;
      margin: 0;
      padding: 6rem 2rem 6rem 2rem;
      position: relative;
      z-index: 2;
      flex: 0 0 45%; /* Adjusted from 40% */
      background-color: white;
    }

    .hero-image {
      flex: 0 0 55%; /* Adjusted from 60% */
      max-width: 55%; /* Adjusted from 60% */
      position: relative;
      display: flex;
      align-items: stretch; /* Changed from center */
      justify-content: stretch; /* Changed from center */
      padding: 0;
      margin: 0;
      height: 100%;
      overflow: hidden;
    }

    .hero-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center;
      margin: 0;
      display: block;
    }

    .hero-title {
      font-size: 3.2rem;
      font-weight: 800;
      color: var(--primary-color);
      margin-bottom: 1.5rem;
      line-height: 1.1;
      letter-spacing: -0.02em;
    }

    .hero-subtitle {
      font-size: 1.1rem;
      color: var(--dark-gray);
      margin-bottom: 2.5rem;
      line-height: 1.6;
      max-width: 600px;
    }

    /* Category Section Styles */
    .category-section {
      padding: 3rem 0 6rem 0;
      background-color: white;
    }

    .category-container {
      margin-bottom: 6rem;
      padding-top: 1rem;
    }

    .category-container:last-child {
      margin-bottom: 0;
    }

    .category-header {
      margin-bottom: 3rem;
      padding: 0.75rem 1.5rem;
      border-radius: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 0.5px solid #e7e5e4;
      background-color: #f5f5f4;
    }

    .category-header-content {
      text-align: left;
    }

    .category-header h2 {
      font-size: 1.8rem;
      color: #292524;
      margin-bottom: 0.5rem;
      font-weight: 700;
    }

    .category-header p {
      color: var(--dark-gray);
      font-size: 1.1rem;
      margin: 0;
    }

    .category-header .view-products {
      margin: 0;
    }

    .products-grid {
      display: flex;
      gap: 2rem;
      overflow-x: auto;
      padding: 1rem;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* IE and Edge */
    }

    .products-grid::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    .product-card {
      flex: 0 0 auto;
      width: 250px;
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      display: flex;
      flex-direction: column;
      border: 1px solid #f0f0f0;
      height: 350px; /* Fixed height for consistency */
    }

    .product-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 12px rgba(0,0,0,0.1);
    }

    .product-image {
      position: relative;
      height: 200px; /* Fixed height for image container */
      overflow: hidden;
      background: #fff;
    }

    .product-image img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: contain;
      transition: transform 0.3s ease;
      padding: 0.5rem;
    }

    .product-info {
      padding: 0.75rem;
      display: flex;
      flex-direction: column;
      flex: 1;
      justify-content: space-between;
    }

    .product-info h3 {
      margin: 0;
      font-size: 1.1rem;
      color: #1f2937;
      text-align: center;
      line-height: 1.2;
      /* Limit to 2 lines with ellipsis */
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      height: 2.6em;
    }

    .product-info p {
      color: var(--dark-gray);
      font-size: 0.9rem;
      line-height: 1.5;
      margin: 0;
    }

    .view-products {
      display: inline-block;
      padding: 0.75rem 1.5rem;
      background: #292524;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      text-decoration: none;
      transition: background-color 0.2s ease;
    }

    .view-products:hover {
      background: #44403c;
    }

    .category-footer {
      text-align: center;
      margin-top: 3rem;
    }

    /* Featured Products */
    .featured-products {
      padding: 6rem 0;
      background-color: white;
    }

    .section-title {
      text-align: center;
      margin-bottom: 1rem;
      font-size: 2.5rem;
      color: var(--primary-color);
      font-weight: 800;
      letter-spacing: -0.02em;
    }

    .section-subtitle {
      text-align: center;
      margin-bottom: 2rem;
      color: var(--dark-gray);
      font-size: 1.25rem;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.6;
    }

    .view-more {
      display: inline-block;
      padding: 1rem 2.5rem;
      background: var(--primary-color);
      color: white;
      border-radius: 12px;
      font-weight: 600;
      transition: all 0.3s ease;
      font-size: 1.1rem;
    }

    .view-more:hover {
      background: #000000;
      transform: translateY(-2px);
    }

    /* Benefits Section */
    .benefits {
      padding: 6rem 0;
      background: var(--light-gray);
    }

    .benefits-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 4rem;
      padding: 2rem 0;
    }

    .benefit-card {
      text-align: center;
      padding: 2.5rem;
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.06);
    }

    .benefit-icon {
      width: 80px;
      height: 80px;
      margin: 0 auto 2rem;
      background: var(--light-gray);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .benefit-card h3 {
      font-size: 1.5rem;
      color: var(--primary-color);
      margin-bottom: 1rem;
      font-weight: 700;
    }

    .benefit-card p {
      color: var(--dark-gray);
      line-height: 1.6;
      font-size: 1rem;
    }

    /* Newsletter Section */
    #contact {
      background-color: white !important;
      padding: 6rem 0 !important;
    }

    #contact .container > div {
      max-width: 900px !important;
      background: var(--light-gray) !important;
      border-radius: 24px !important;
      padding: 4rem !important;
    }

    /* Responsive Design */
    @media (max-width: 1200px) {
      .product-grid {
        grid-template-columns: repeat(4, 1fr);
      }
    }

    @media (max-width: 960px) {
      .hero-banner {
        flex-direction: column;
        min-height: auto;
      }

      .hero-content, .hero-image {
        flex: 0 0 100%;
        max-width: 100%;
      }
      
      .hero-content {
        padding: 4rem 2rem;
      }

      .hero-image {
        height: 600px; /* Increased height for mobile */
      }
    }

    @media (max-width: 768px) {
      .container {
        padding: 0 1.5rem;
      }
      
      .hero-title {
        font-size: 3rem;
      }
      
      .hero-subtitle {
        font-size: 1.1rem;
      }
      
      .section-title {
        font-size: 2rem;
      }
      
      .section-subtitle {
        font-size: 1.1rem;
      }
      
      .product-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 480px) {
      .product-grid {
        grid-template-columns: 1fr;
      }
    }

    .product-action-buttons {
      margin-top: auto;
      display: flex;
      justify-content: center;
      padding: 0.75rem 0 0 0;
    }

    .primary-button {
      width: 100%;
      max-width: 180px;
      margin: 0 auto;
      background-color: #292524;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 0.6rem 1rem;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s;
      text-align: center;
      height: 35px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .primary-button:hover {
      background-color: #44403c;
    }

    /* Add smooth scroll buttons */
    .products-container {
      position: relative;
      max-width: 100%;
      margin: 0 auto;
      padding: 0 3rem;
    }

    .scroll-button {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 40px;
      height: 40px;
      background: rgba(41, 37, 36, 0.8);
      border: none;
      border-radius: 50%;
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      transition: background-color 0.2s;
    }

    .scroll-button:hover {
      background: rgba(41, 37, 36, 1);
    }

    .scroll-left {
      left: 0;
    }

    .scroll-right {
      right: 0;
    }

    .scroll-button svg {
      width: 24px;
      height: 24px;
    }

    .file-upload-container {
        position: relative;
        margin-bottom: 1rem;
        cursor: pointer;
    }

    .file-input {
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        opacity: 0;
        cursor: pointer;
        z-index: 2;
    }

    .file-upload-button {
        position: relative;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1rem;
        background-color: #f5f5f4;
        border: 1px dashed #d6d3d1;
        border-radius: 8px;
        color: #57534e;
        font-size: 0.9rem;
        cursor: pointer;
        transition: all 0.2s;
        z-index: 1;
        min-height: 48px;
    }

    .file-upload-button:hover {
        background-color: #e7e5e4;
        border-color: #a8a29e;
    }

    .selected-files {
        margin-top: 0.5rem;
    }

    .selected-file {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0.5rem;
        background-color: #f5f5f4;
        border-radius: 4px;
        margin-bottom: 0.5rem;
        font-size: 0.85rem;
    }

    .selected-file .remove-file {
        cursor: pointer;
        color: #ef4444;
        padding: 0.25rem;
    }

    .upload-progress {
        height: 2px;
        background-color: #e7e5e4;
        border-radius: 2px;
        overflow: hidden;
        margin-top: 0.25rem;
    }

    .upload-progress-bar {
        height: 100%;
        background-color: #22c55e;
        transition: width 0.3s ease;
    }
  </style>
</head>
<body>
  <!-- Load Header -->
  <div id="my-header"></div>

  <!-- Hero Banner -->
  <section class="hero-banner">
      <div class="hero-content">
      <h1 class="hero-title">
        Modern Workspace Design
      </h1>
      <p class="hero-subtitle">
        Create inspiring workspaces with our curated collection of contemporary office furniture. Designed for the modern professional who values both aesthetics and functionality.
      </p>
      <div style="display: flex; gap: 1.5rem; margin-top: 3rem;">
        <a href="collections.html" class="view-more" target="_blank">
          Explore Collection
          </a>
          <a href="#" id="hero-quote-btn" style="
            display: inline-block;
          padding: 1rem 2.5rem;
          background: transparent;
          color: var(--primary-color);
          border-radius: 12px;
          font-weight: 600;
          border: 2px solid var(--primary-color);
          transition: all 0.3s ease;
          font-size: 1.1rem;
        ">
          Get Quote
          </a>
        </div>
        <div style="margin-top: 2rem; display: flex; flex-direction: column; gap: 0.5rem;">
          <a href="mailto:sales@modernaoffice.co.za" style="display: flex; align-items: center; gap: 0.5rem; color: #44403c; text-decoration: none; font-size: 1.2rem; font-weight: 500;">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
              <polyline points="22,6 12,13 2,6"></polyline>
            </svg>
            sales@modernaoffice.co.za
          </a>
          <a href="tel:0645367341" style="display: flex; align-items: center; gap: 0.5rem; color: #44403c; text-decoration: none; font-size: 1.2rem; font-weight: 500;">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
            </svg>
            <span style="display: inline-block; color: #292524;">064 536 7341</span>
          </a>
      </div>
      </div>
      <div class="hero-image">
        <img src="images/newfront.jpg" alt="Modern Office Interior">
      </div>
    </section>

  <!-- Collections Section -->
  <section class="category-section">
    <div class="container">
      <!-- Categories will be dynamically loaded here -->
      </div>
    </section>

  <!-- Benefits Section -->
  <section class="benefits">
    <div class="container">
      <div class="benefits-grid">
        <div class="benefit-card">
          <div class="benefit-icon">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
              <polyline points="22 4 12,14.01 2,6"></polyline>
            </svg>
          </div>
          <h3>Premium Quality</h3>
          <p>Crafted with premium materials and built to last, our furniture combines durability with sophisticated design</p>
        </div>
        
        <div class="benefit-card">
          <div class="benefit-icon">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M12 6v6l4 2"/>
            </svg>
          </div>
          <h3>Quick Setup</h3>
          <p>Professional installation service available with quick turnaround times to minimize disruption</p>
        </div>
        
        <div class="benefit-card">
          <div class="benefit-icon">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
            </svg>
          </div>
          <h3>Design Consultation</h3>
          <p>Free consultation with our design experts to create your perfect workspace</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Newsletter Section -->
    <section id="contact" style="
      width: 100%;
      background-color: #fff;
    padding: 5rem 0;
    border-top: 1px solid #eee;
  ">
    <div class="container">
      <div style="
        max-width: 800px;
        margin: 0 auto;
        text-align: center;
        background: white;
        padding: 3rem;
        border-radius: 12px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
      ">
        <div style="
          width: 48px;
          height: 48px;
          background: #f5f5f4;
          border-radius: 50%;
          margin: 0 auto 1.5rem;
          display: flex;
          align-items: center;
          justify-content: center;
        ">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            <path d="M9 12l2 2 4-4"/>
          </svg>
        </div>
        <h2 style="
          font-size: 1.5rem;
          font-weight: 700;
          margin-bottom: 1rem;
          color: #292524;
        ">
          Never miss an update
        </h2>
        <p style="
          color: #78716c;
          font-size: 1rem;
          margin-bottom: 1.5rem;
        ">
          Subscribe to receive news and special offers.
        </p>
        <div style="
          max-width: 1000px;
          margin: 0 auto;
          padding: 0 1rem;
        ">
          <form action="#" method="POST" style="
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            justify-content: center;
            flex-direction: row;
            align-items: center;
          ">
            <div style="
              display: flex;
              gap: 1.5rem;
              width: 100%;
              margin: 0 auto;
            ">
              <input 
                type="text" 
                id="name"
                placeholder="Enter your name"
                required
                style="
                  width: 50%;
                  padding: 0.6rem 0.8rem;
                  font-size: 1rem;
                  border: 1px solid #e7e5e4;
                  border-radius: 8px;
                  background: #fafaf9;
                  height: 38px;
                "
              />
              <input 
                type="email" 
                id="email"
                placeholder="Enter your email"
                required
                style="
                  width: 50%;
                  padding: 0.6rem 0.8rem;
                  font-size: 1rem;
                  border: 1px solid #e7e5e4;
                  border-radius: 8px;
                  background: #fafaf9;
                  height: 38px;
                "
              />
            </div>
            <div style="
              display: flex;
              gap: 1.5rem;
              width: 100%;
              margin: 0 auto;
              margin-bottom: 1.5rem;
            ">
              <input 
                type="tel" 
                id="phone"
                placeholder="Enter your phone number (optional)"
                style="
                  width: 50%;
                  padding: 0.6rem 0.8rem;
                  font-size: 1rem;
                  border: 1px solid #e7e5e4;
                  border-radius: 8px;
                  background: #fafaf9;
                  height: 38px;
                "
              />
              <input 
                type="text" 
                id="company"
                placeholder="Enter your company name (optional)"
                style="
                  width: 50%;
                  padding: 0.6rem 0.8rem;
                  font-size: 1rem;
                  border: 1px solid #e7e5e4;
                  border-radius: 8px;
                  background: #fafaf9;
                  height: 38px;
                "
              />
            </div>
            <div class="form-group">
                <label for="message">Message</label>
                <textarea id="message" placeholder="Your message"></textarea>
            </div>
            <div class="form-group">
                <label for="attachments">Attachments</label>
                <div class="file-upload-container" onclick="document.getElementById('attachments').click()">
                    <input type="file" id="attachments" name="attachments" multiple class="file-input" accept="image/*,.pdf,.doc,.docx">
                    <div class="file-upload-button">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17 8 12 3 7 8"/>
                            <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                        Choose Files
                    </div>
                </div>
                <div id="selected-files" class="selected-files"></div>
            </div>
            <button type="submit" class="submit-btn">Submit</button>
          </form>
        </div>
        </div>
      </div>
    </section>

    <!-- Footer inline -->
    <div id="footer-placeholder">
    <footer style="
      text-align: center;
      padding: 2rem 1rem;
      background-color: #fff;
      box-shadow: 0 -1px 4px rgba(0,0,0,0.05);
          margin-top: 2rem;
      ">
          <div style="max-width: 1200px; margin: 0 auto; display: flex; flex-direction: column; gap: 1.5rem;">
              <!-- Contact Us section with both email and phone -->
              <div style="text-align: center; padding: 1rem; border-bottom: 1px solid #f5f5f4;">
                  <div style="font-size: 0.95rem; font-weight: 600; color: #44403c; margin-bottom: 1rem;">
                      Contact Us
                  </div>
                  <div style="display: flex; flex-direction: row; justify-content: center; gap: 2rem; flex-wrap: wrap;">
                      <a href="mailto:sales@modernaoffice.co.za" style="
                          display: inline-flex;
                          align-items: center;
                          gap: 0.5rem;
                          color: #292524;
                          text-decoration: none;
                          font-size: 1.1rem;
                          font-weight: 600;
                          white-space: nowrap;
                      ">
                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                              <polyline points="22,6 12,13 2,6"></polyline>
                          </svg>
                          sales@modernaoffice.co.za
                      </a>
                      <a href="tel:0645367341" style="
                          display: inline-flex;
                          align-items: center;
                          gap: 0.5rem;
                          color: #292524;
                          text-decoration: none;
                          font-size: 1.1rem;
                          font-weight: 600;
                          white-space: nowrap;
                      ">
                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                              <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                          </svg>
                          <span style="display: inline-block; color: #292524;">064 536 7341</span>
                      </a>
                  </div>
              </div>
              
              <p style="font-size: 0.85rem; color: #78716c; margin: 0;">
                  Â© 2025 Moderna Office Furniture. All rights reserved.
              </p>
          </div>
    </footer>
  </div>

  <!-- Load Quote Modal -->
  <div id="quote-modal-container"></div>
  <script type="module">
    import { QuoteModal } from './js/modal.js';
    import { createClient } from 'https://esm.sh/@supabase/supabase-js';

    const SUPABASE_URL = 'https://rpncvcioutyrxntqvlnd.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJwbmN2Y2lvdXR5cnhudHF2bG5kIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzkyOTgxNzIsImV4cCI6MjA1NDg3NDE3Mn0.Rm4cDLV4cNubgwDV3SgLt2cC5E3fO4JOuXoK0DrKrzQ';
    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // Function to fetch products by category with pagination
    async function fetchProductsByCategory(categoryId, offset = 0, limit = 6) {
      console.log(`Fetching products for category ${categoryId}... (offset: ${offset}, limit: ${limit})`);
      try {
        const { data, error } = await supabase
          .from('products_with_categories')
          .select(`
            product_id,
            product_name,
            product_image,
            category_id,
            category_name
          `)
          .eq('category_id', categoryId);

        if (error) {
          console.error('Error fetching products:', error);
          throw error;
        }

        // Custom sorting based on category
        if (data && data.length > 0) {
          if (data[0].category_name === 'Office Chairs') {
            // Chair order
            const chairOrder = ['Gem', 'Dexter', 'Gem', 'Majestic', 'Lugano', 'Kingston'];
            
            data.sort((a, b) => {
              const nameA = a.product_name;
              const nameB = b.product_name;
              
              const orderA = chairOrder.findIndex(name => nameA.startsWith(name));
              const orderB = chairOrder.findIndex(name => nameB.startsWith(name));
              
              if (orderA !== -1 && orderB !== -1) return orderA - orderB;
              if (orderA !== -1) return -1;
              if (orderB !== -1) return 1;
              
              return nameA.localeCompare(nameB);
            });
          } else if (data[0].category_name === 'Desking') {
            // Desking order
            const deskingOrder = [
              'Synergy - Eight Seater',
              'Synergy - Four Seater',
              'Synergy - Six Seater',
              'Synergy - Two Seater',
              'Summit + Hinge Door',
              'Summit + Pedestal',
              'Summit + Roller Door',
              'Summit + Sliding Door'
            ];
            
            data.sort((a, b) => {
              const nameA = a.product_name;
              const nameB = b.product_name;
              
              const orderA = deskingOrder.indexOf(nameA);
              const orderB = deskingOrder.indexOf(nameB);
              
              if (orderA !== -1 && orderB !== -1) return orderA - orderB;
              if (orderA !== -1) return -1;
              if (orderB !== -1) return 1;
              
              return nameA.localeCompare(nameB);
            });
          } else if (data[0].category_name === 'Storage') {
            // Storage order
            const storageOrder = [
              'Cupboards',
              'Desk Height',
              'Mobile',
              'Hinge Door - Side Storage',
              'Rollerdoor Side Storage',
              'Sliding Door Side Storage'
            ];
            
            data.sort((a, b) => {
              const nameA = a.product_name;
              const nameB = b.product_name;
              
              const orderA = storageOrder.indexOf(nameA);
              const orderB = storageOrder.indexOf(nameB);
              
              const partialOrderA = storageOrder.findIndex(name => nameA.startsWith(name));
              const partialOrderB = storageOrder.findIndex(name => nameB.startsWith(name));
              
              if (orderA !== -1 && orderB !== -1) return orderA - orderB;
              if (partialOrderA !== -1 && partialOrderB !== -1) return partialOrderA - partialOrderB;
              if (orderA !== -1 || partialOrderA !== -1) return -1;
              if (orderB !== -1 || partialOrderB !== -1) return 1;
              
              return nameA.localeCompare(nameB);
            });
          } else if (data[0].category_name === 'Executive Desk') {
            // Executive Desk order
            const executiveOrder = [
              'Elevate Executive Desk',
              'Zenith',
              'Aston',
              'Alabama'
            ];
            
            data.sort((a, b) => {
              const nameA = a.product_name;
              const nameB = b.product_name;
              
              const orderA = executiveOrder.indexOf(nameA);
              const orderB = executiveOrder.indexOf(nameB);
              
              const partialOrderA = executiveOrder.findIndex(name => nameA.startsWith(name));
              const partialOrderB = executiveOrder.findIndex(name => nameB.startsWith(name));
              
              if (orderA !== -1 && orderB !== -1) return orderA - orderB;
              if (partialOrderA !== -1 && partialOrderB !== -1) return partialOrderA - partialOrderB;
              if (orderA !== -1 || partialOrderA !== -1) return -1;
              if (orderB !== -1 || partialOrderB !== -1) return 1;
              
              return nameA.localeCompare(nameB);
            });
          } else if (data[0].category_name === 'Couches') {
            // Couch order
            const couchOrder = [
              'The Elmstead',
              'Arcadia',
              'Puzzle Round',
              'The Lennox'
            ];
            
            data.sort((a, b) => {
              const nameA = a.product_name;
              const nameB = b.product_name;
              
              const orderA = couchOrder.indexOf(nameA);
              const orderB = couchOrder.indexOf(nameB);
              
              const partialOrderA = couchOrder.findIndex(name => nameA.startsWith(name));
              const partialOrderB = couchOrder.findIndex(name => nameB.startsWith(name));
              
              if (orderA !== -1 && orderB !== -1) return orderA - orderB;
              if (partialOrderA !== -1 && partialOrderB !== -1) return partialOrderA - partialOrderB;
              if (orderA !== -1 || partialOrderA !== -1) return -1;
              if (orderB !== -1 || partialOrderB !== -1) return 1;
              
              return nameA.localeCompare(nameB);
            });
          } else {
            // For other categories, sort alphabetically
            data.sort((a, b) => a.product_name.localeCompare(b.product_name));
          }
        }

        // Store the full data set in a data attribute on the container
        const container = document.querySelector(`#category-${categoryId} .products-grid`);
        if (container) {
          container.dataset.fullProducts = JSON.stringify(data);
        }

        // Return the paginated subset
        return data.slice(offset, offset + limit) || [];
      } catch (error) {
        console.error('Error in fetchProductsByCategory:', error);
        return [];
      }
    }

    // Function to handle lazy loading of more products
    async function loadMoreProducts(categoryId, container) {
      try {
        // Get the full product set from the container's data attribute
        const fullProducts = JSON.parse(container.dataset.fullProducts || '[]');
        const currentProducts = container.querySelectorAll('.product-card').length;
        
        // Check if we have more products to load
        if (currentProducts >= fullProducts.length) {
          console.log('No more products to load');
          return;
        }
        
        // Get the next batch of products
        const nextProducts = fullProducts.slice(currentProducts, currentProducts + 6);
        
        if (nextProducts && nextProducts.length > 0) {
          const fragment = document.createDocumentFragment();
          
          nextProducts.forEach(product => {
            const productCard = document.createElement('div');
            productCard.className = 'product-card';
            productCard.style.opacity = '0';
            productCard.style.transform = 'translateY(10px)';
            productCard.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
            
            productCard.innerHTML = `
              <div class="product-image">
                <a href="product-detail.html?id=${product.product_id}">
                  <img src="${product.product_image || 'placeholder.jpg'}" 
                       alt="${product.product_name}"
                       loading="lazy">
                </a>
              </div>
              <div class="product-info">
                <h3>${product.product_name}</h3>
                <div class="product-action-buttons">
                  <button class="primary-button add-to-quote-btn" 
                          data-product-id="${product.product_id}" 
                          data-product-name="${product.product_name}">
                    Add to Quote
                  </button>
                </div>
              </div>
            `;

            // Add event listener before adding to fragment
            const quoteButton = productCard.querySelector('.add-to-quote-btn');
            quoteButton.addEventListener('click', function(e) {
              e.preventDefault();
              const productId = this.getAttribute('data-product-id');
              const productName = this.getAttribute('data-product-name');
              
              if (typeof window.addToQuote === 'function') {
                window.addToQuote({
                  id: productId,
                  name: productName,
                  quantity: 1
                });
              }
            });

            fragment.appendChild(productCard);
          });

          container.appendChild(fragment);

          // Fade in new products with a stagger effect
          container.querySelectorAll('.product-card[style*="opacity: 0"]').forEach((card, index) => {
            setTimeout(() => {
              card.style.opacity = '1';
              card.style.transform = 'translateY(0)';
            }, index * 50);
          });

          // Update scroll buttons after adding new products
          updateScrollButtons();
        }
      } catch (error) {
        console.error('Error in loadMoreProducts:', error);
      }
    }

    // Update scroll event listener to include lazy loading
    function addScrollListeners() {
      document.querySelectorAll('.products-grid').forEach(grid => {
        let isLoading = false; // Flag to prevent multiple simultaneous loads
        
        grid.addEventListener('scroll', async function() {
          if (isLoading) return;
          
          updateScrollButtons();
          
          // Check if we're near the end of scrolling
          const scrollPosition = this.scrollLeft + this.clientWidth;
          const scrollThreshold = this.scrollWidth - 200; // Load more when within 200px of the end
          
          if (scrollPosition > scrollThreshold) {
            isLoading = true;
            const categoryId = this.closest('[id^="category-"]').id.replace('category-', '');
            await loadMoreProducts(categoryId, this);
            isLoading = false;
          }
        });
      });
      
      // Initial update of button visibility
      updateScrollButtons();
      
      // Add resize listener to update buttons on window resize
      window.addEventListener('resize', updateScrollButtons);
    }

    // First load the header - MOVE THIS OUTSIDE OF DOMContentLoaded
    async function initializeApp() {
      try {
        console.log('Initializing app...');
        
        // Load modal
        const modalResponse = await fetch('quote-modal.html');
        const modalData = await modalResponse.text();
        document.getElementById('quote-modal-container').innerHTML = modalData;
        
        // Initialize modal
        window.quoteModal = new QuoteModal();
        
        // Load categories and products
        await loadCategoriesAndProducts();
        
        // Setup quote button
          const heroQuoteBtn = document.getElementById('hero-quote-btn');
          if (heroQuoteBtn) {
            heroQuoteBtn.addEventListener('click', (e) => {
              e.preventDefault();
              const modalOverlay = document.getElementById('quote-modal-overlay');
              if (modalOverlay) {
                modalOverlay.style.display = 'flex';
                if (typeof refreshQuoteTable === 'function') {
                  refreshQuoteTable();
                }
              }
            });
          }
      } catch (err) {
        console.error('Error during initialization:', err);
      }
    }

    // Window global for view more function
    window.showMore = function(categoryId) {
      console.log(`Showing more products for category ${categoryId}`);
      // You can implement a modal or redirect to a category page
    };

    // Clean up our event listeners
    document.addEventListener('DOMContentLoaded', async () => {
      console.log('DOM Content Loaded, initializing...');
      
      try {
        // Test Supabase connection using the view
        console.log('Testing Supabase connection...');
        const { data: products, error: productsError } = await supabase
          .from('products_with_categories')
          .select('*')
          .limit(1);

        if (productsError) {
          console.error('Error accessing products view:', productsError);
          throw productsError;
        }

        console.log('Successfully connected to products view:', products);

        // Now try to fetch a category
        const { data: categories, error: categoriesError } = await supabase
          .from('categories')
          .select('*')
          .limit(1);

        if (categoriesError) {
          console.error('Error accessing categories table:', categoriesError);
          throw categoriesError;
        }

        console.log('Successfully connected to categories table:', categories);

        // If we get here, both tables exist and are accessible
        await initializeApp(); // Call our new initialization function
        
      } catch (err) {
        console.error('Database connection error:', err);
        // Display error message on the page
        const container = document.querySelector('.category-section .container');
        if (container) {
          container.innerHTML += `
            <div style="text-align: center; color: red; margin-top: 2rem;">
              Error connecting to database. Please check the console for details.
            </div>
          `;
        }
      }
    });

    // Function to sort categories in custom order
    function sortCategories(categories) {
      const customOrder = [
        'Office Chairs',
        'Desking',
        'Executive Desk',
        'Storage',
        'Reception Counters',
        'Couches'
      ];
      
      // Create a map for quick lookup of priority
      const priorityMap = new Map(
        customOrder.map((name, index) => [name, index])
      );
      
      return categories.sort((a, b) => {
        // Special case: Always put Ottoman at the end
        if (a.name === 'Ottoman') return 1;
        if (b.name === 'Ottoman') return -1;
        
        const aIndex = priorityMap.get(a.name);
        const bIndex = priorityMap.get(b.name);
        
        // If both categories are in the priority list, sort by their index
        if (aIndex !== undefined && bIndex !== undefined) {
          return aIndex - bIndex;
        }
        
        // If only one is in the priority list, it should come first
        if (aIndex !== undefined) return -1;
        if (bIndex !== undefined) return 1;
        
        // For all other categories, sort alphabetically
        return a.name.localeCompare(b.name);
      });
    }

    // Function to render products with smooth loading
    function renderProducts(products, containerId) {
      console.log('Rendering products for container:', containerId, products);
      const container = document.querySelector(`#${containerId} .products-grid`);
      if (!container) {
        console.error('Container not found:', containerId);
        return;
      }

      if (!products || products.length === 0) {
        console.log('No products to display for:', containerId);
        container.innerHTML = '<p>No products available in this category.</p>';
        return;
      }

      // Create a document fragment to build the content off-DOM
      const fragment = document.createDocumentFragment();
      
      products.forEach(product => {
        const productCard = document.createElement('div');
        productCard.className = 'product-card';
        productCard.style.opacity = '0';
        productCard.style.transform = 'translateY(10px)';
        productCard.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
        
        productCard.innerHTML = `
          <div class="product-image">
            <a href="product-detail.html?id=${product.product_id}">
              <img src="${product.product_image || 'placeholder.jpg'}" 
                   alt="${product.product_name}"
                   loading="lazy">
            </a>
          </div>
          <div class="product-info">
            <h3>${product.product_name}</h3>
            <div class="product-action-buttons">
              <button class="primary-button add-to-quote-btn" 
                      data-product-id="${product.product_id}" 
                      data-product-name="${product.product_name}">
                Add to Quote
              </button>
            </div>
          </div>
        `;

        // Add event listener before adding to fragment
        const quoteButton = productCard.querySelector('.add-to-quote-btn');
        quoteButton.addEventListener('click', function(e) {
          e.preventDefault();
          const productId = this.getAttribute('data-product-id');
          const productName = this.getAttribute('data-product-name');
          
          if (typeof window.addToQuote === 'function') {
            window.addToQuote({
              id: productId,
              name: productName,
              quantity: 1
            });
          }
        });

        fragment.appendChild(productCard);
      });

      // Clear the container and append all products at once
      container.innerHTML = '';
      container.appendChild(fragment);

      // Trigger reflow before adding animations
      container.offsetHeight;

      // Fade in products with a stagger effect
      container.querySelectorAll('.product-card').forEach((card, index) => {
        setTimeout(() => {
          card.style.opacity = '1';
          card.style.transform = 'translateY(0)';
        }, index * 50); // 50ms delay between each card
      });
    }

    // Update loadCategoriesAndProducts to load more smoothly
    async function loadCategoriesAndProducts() {
      console.log('Loading categories and products...');
      const container = document.querySelector('.category-section .container');
      
      try {
        const { data: categories, error: categoriesError } = await supabase
          .from('categories')
          .select('*');
        
        if (categoriesError) {
          console.error('Error loading categories:', categoriesError);
          return;
        }
        
        if (!categories || categories.length === 0) {
          container.innerHTML = '<div style="text-align: center; margin-top: 2rem;"><p>No categories available.</p></div>';
          return;
        }
        
        // Sort categories in custom order
        const sortedCategories = sortCategories(categories);
        
        // First, render all category containers without products
        container.innerHTML = sortedCategories.map(category => renderCategorySection(category)).join('');
        
        // Then load products for each category sequentially
        for (const category of sortedCategories) {
          const products = await fetchProductsByCategory(category.id);
          renderProducts(products, `category-${category.id}`);
          await new Promise(resolve => setTimeout(resolve, 100)); // Small delay between categories
        }

        // Add scroll listeners after all categories and products are loaded
        addScrollListeners();
      } catch (err) {
        console.error('Error in loadCategoriesAndProducts:', err);
        container.innerHTML = `
          <div style="text-align: center; margin-top: 2rem;">
            <p>Error loading categories. Please try refreshing the page.</p>
          </div>
        `;
      }
    }

    // Function to render category section
    function renderCategorySection(category) {
      return `
        <div class="category-section" id="category-${category.id}">
          <div class="category-header">
            <h2>${category.name}</h2>
            <a href="products.html?category=${category.id}" class="view-products">View Full Collection</a>
          </div>
          <div class="products-container">
            <button class="scroll-button scroll-left" onclick="scrollProducts('category-${category.id}', 'left')">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M15 19l-7-7 7-7"/>
              </svg>
            </button>
            <div class="products-grid">
              <!-- Products will be loaded here -->
            </div>
            <button class="scroll-button scroll-right" onclick="scrollProducts('category-${category.id}', 'right')">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 5l7 7-7 7"/>
              </svg>
            </button>
          </div>
        </div>
      `;
    }

    // Initialize global functions
    window.scrollProducts = function(categoryId, direction) {
      const container = document.querySelector(`#${categoryId} .products-grid`);
      if (!container) return;

      const scrollAmount = 600; // Adjust this value to control scroll distance
      const currentScroll = container.scrollLeft;
      
      container.scrollTo({
        left: direction === 'left' ? currentScroll - scrollAmount : currentScroll + scrollAmount,
        behavior: 'smooth'
      });

      // Update button visibility after scrolling
      updateScrollButtons();
    };

    // Update visibility of scroll buttons based on scroll position
    function updateScrollButtons() {
      document.querySelectorAll('.products-container').forEach(container => {
        const grid = container.querySelector('.products-grid');
        const leftButton = container.querySelector('.scroll-left');
        const rightButton = container.querySelector('.scroll-right');
        
        if (grid && leftButton && rightButton) {
          // Show/hide left button based on scroll position
          leftButton.style.opacity = grid.scrollLeft > 0 ? '1' : '0';
          leftButton.style.visibility = grid.scrollLeft > 0 ? 'visible' : 'hidden';
          
          // Show/hide right button based on whether there's more content to scroll
          const maxScroll = grid.scrollWidth - grid.clientWidth;
          rightButton.style.opacity = grid.scrollLeft < maxScroll ? '1' : '0';
          rightButton.style.visibility = grid.scrollLeft < maxScroll ? 'visible' : 'hidden';
        }
      });
    }

    const form = document.querySelector('form');
    const messageDiv = document.getElementById('subscription-message');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const submitButton = form.querySelector('button[type="submit"]');
      submitButton.disabled = true;
      submitButton.textContent = 'Subscribing...';

      try {
        const formData = {
          name: document.getElementById('name').value,
          email: document.getElementById('email').value,
          phone: document.getElementById('phone').value || null,
          company: document.getElementById('company').value || null,
        };

        const { data, error } = await supabase
          .from('newsletter_subscribers')
          .insert([formData]);

        if (error) {
          throw error;
        }

        // Show success message
        messageDiv.style.display = 'block';
        messageDiv.style.backgroundColor = '#f0fdf4';
        messageDiv.style.color = '#166534';
        messageDiv.style.border = '1px solid #bbf7d0';
        messageDiv.textContent = 'Thank you for subscribing to our newsletter!';
        
        // Reset form
        form.reset();

      } catch (error) {
        console.error('Detailed error:', error);
        // Show error message
        messageDiv.style.display = 'block';
        messageDiv.style.backgroundColor = '#fef2f2';
        messageDiv.style.color = '#b91c1c';
        messageDiv.style.border = '1px solid #fecaca';
        messageDiv.textContent = 'Sorry, there was an error. Please try again later.';
      } finally {
        // Re-enable submit button
        submitButton.disabled = false;
        submitButton.textContent = 'Subscribe';
      }
    });

    // Load footer
    fetch('footer.html')
        .then(response => {
            if (!response.ok) {
                throw new Error('Failed to load footer');
            }
            return response.text();
        })
        .then(data => {
            document.getElementById('footer-placeholder').innerHTML = data;
        })
        .catch(err => {
            console.error('Error loading footer:', err);
            // We already have a fallback footer in the HTML
    });

    // Add event listener for the hero quote button
    document.getElementById('hero-quote-btn').addEventListener('click', function(e) {
        e.preventDefault();
        window.location.href = 'contact.html';
    });
  </script>
  <!-- WhatsApp Button -->
  <a href="https://wa.me/27645367341" class="whatsapp-button" target="_blank" rel="noopener noreferrer">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
      <path d="M12.031 6.172c-3.181 0-5.767 2.586-5.768 5.766-.001 1.298.38 2.27 1.019 3.287l-.582 2.128 2.182-.573c.978.58 1.911.928 3.145.929 3.178 0 5.767-2.587 5.768-5.766.001-3.187-2.575-5.771-5.764-5.771zm3.392 8.244c-.144.405-.837.774-1.17.824-.299.045-.677.063-1.092-.069-.252-.08-.575-.187-.988-.365-1.739-.751-2.874-2.502-2.961-2.617-.087-.116-.708-.94-.708-1.793s.448-1.273.607-1.446c.159-.173.346-.217.462-.217l.332.006c.106.005.249-.04.39.298.144.347.491 1.2.534 1.287.043.087.072.072.188.014.304-.058.116-.087.188-.173.289l-.26.304c-.087.086-.177.18-.076.354.101.174.449.741.964 1.201.662.591 1.221.774 1.394.86s.274.072.376-.043c.101-.116.433-.506.549-.68.116-.173.231-.145.39-.087s1.011.477 1.184.564.289.13.332.202c.045.072.045.419-.1.824zm-3.423-14.416c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm.029 18.88c-1.161 0-2.305-.292-3.318-.844l-3.677.964.984-3.595c-.607-1.052-.927-2.246-.926-3.468.001-3.825 3.113-6.937 6.937-6.937 1.856.001 3.598.723 4.907 2.034 1.31 1.311 2.031 3.054 2.03 4.908-.001 3.825-3.113 6.938-6.937 6.938z"/>
    </svg>
  </a>

  <style>
    .whatsapp-button {
      position: fixed;
      bottom: 24px;
      left: 24px;
      background-color: #ffffff;
      color: white;
      border-radius: 50%;
      width: 55px;
      height: 55px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
      transition: all 0.3s ease;
      z-index: 1000;
      transform: translate3d(0, 0, 0);
      backface-visibility: hidden;
      perspective: 1000px;
    }

    .whatsapp-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      animation: none;
    }

    .whatsapp-button svg {
      width: 38px;
      height: 38px;
      color: #25D366;
    }

    @media (max-width: 768px) {
      .whatsapp-button {
        width: 45px;
        height: 45px;
        bottom: 16px;
        left: 16px;
      }
      
      .whatsapp-button svg {
        width: 30px;
        height: 30px;
      }
    }
  </style>

  <!-- Contact Pop-up Modal -->
  <div id="contact-modal" class="modal">
      <div class="modal-content">
          <span class="close-button">&times;</span>
          <h2>Looking for something specific? Email us</h2>
          <form id="contact-form">
              <div class="form-group">
                  <label for="name">Name</label>
                  <input type="text" id="name" placeholder="Your name">
              </div>
              <div class="form-group">
                  <label for="email">Email <span class="required">*</span></label>
                  <input type="email" id="email" placeholder="Your email" required>
              </div>
              <div class="form-group">
                  <label for="cell_number">Contact Number</label>
                  <input type="tel" id="cell_number" placeholder="Your contact number">
              </div>
              <div class="form-group">
                  <label for="message">Message</label>
                  <textarea id="message" placeholder="Your message"></textarea>
              </div>
              <div class="form-group">
                  <label for="attachments">Attachments</label>
                  <div class="file-upload-container" onclick="document.getElementById('attachments').click()">
                      <input type="file" id="attachments" name="attachments" multiple class="file-input" accept="image/*,.pdf,.doc,.docx">
                      <div class="file-upload-button">
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                              <polyline points="17 8 12 3 7 8"/>
                              <line x1="12" y1="3" x2="12" y2="15"/>
                          </svg>
                          Choose Files
                      </div>
                  </div>
                  <div id="selected-files" class="selected-files"></div>
              </div>
              <button type="submit" class="submit-btn">Submit</button>
          </form>
      </div>
  </div>

  <style>
      .modal {
          display: none;
          position: fixed;
          z-index: 10000;
          left: 0;
          top: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.5);
          opacity: 0;
          transition: opacity 0.3s ease;
          overflow-y: auto; /* Enable vertical scrolling */
          padding: 20px; /* Add padding for mobile */
      }

      .modal.show {
          display: block;
          opacity: 1;
      }

      .modal-content {
          background-color: #fff;
          margin: 5vh auto; /* Changed from 15% to 5vh for better positioning */
          padding: 2rem;
          border-radius: 12px;
          width: 90%;
          max-width: 500px;
          position: relative;
          transform: translateY(-20px);
          transition: transform 0.3s ease;
      }

      @media (max-height: 800px) {
          .modal-content {
              margin: 2vh auto; /* Even less margin for shorter screens */
          }
      }

      @media (max-width: 480px) {
          .modal {
              padding: 10px; /* Less padding on mobile */
          }
          
          .modal-content {
              padding: 1.5rem; /* Less padding in modal on mobile */
              margin: 2vh auto; /* Less margin on mobile */
          }

          .form-group {
              margin-bottom: 0.75rem; /* Slightly less spacing between form groups on mobile */
          }
      }

      .close-button {
          position: absolute;
          right: 1.5rem;
          top: 1.5rem;
          font-size: 1.5rem;
          cursor: pointer;
          color: #78716c;
      }

      .close-button:hover {
          color: #292524;
      }

      .modal h2 {
          color: #292524;
          font-size: 1.5rem;
          font-weight: 600;
          margin-bottom: 1.5rem;
      }

      .form-group {
          margin-bottom: 1rem;
      }

      .form-group label {
          display: block;
          color: #57534e;
          font-size: 0.9rem;
          margin-bottom: 0.5rem;
      }

      .form-group input,
      .form-group textarea {
          width: 100%;
          padding: 0.75rem;
          border: 1px solid #e7e5e4;
          border-radius: 8px;
          font-size: 1rem;
          transition: border-color 0.2s;
      }

      .form-group textarea {
          height: 100px;
          resize: vertical;
      }

      .form-group input:focus,
      .form-group textarea:focus {
          outline: none;
          border-color: #78716c;
      }

      .required {
          color: #ef4444;
      }

      .submit-btn {
          width: 100%;
          padding: 0.875rem;
          background: #292524;
          color: white;
          border: none;
          border-radius: 8px;
          font-size: 1rem;
          font-weight: 500;
          cursor: pointer;
          transition: background-color 0.2s;
      }

      .submit-btn:hover {
          background: #44403c;
      }

      .error-message {
          color: #ef4444;
          font-size: 0.875rem;
          margin-top: 0.25rem;
          display: none;
      }

      .error-message.show {
          display: block;
      }
  </style>

  <script type="module">
      import { createClient } from 'https://esm.sh/@supabase/supabase-js';

      const CONTACT_FORM_SUPABASE_URL = 'https://rpncvcioutyrxntqvlnd.supabase.co';
      const CONTACT_FORM_SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJwbmN2Y2lvdXR5cnhudHF2bG5kIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzkyOTgxNzIsImV4cCI6MjA1NDg3NDE3Mn0.Rm4cDLV4cNubgwDV3SgLt2cC5E3fO4JOuXoK0DrKrzQ';
      const contactFormSupabase = createClient(CONTACT_FORM_SUPABASE_URL, CONTACT_FORM_SUPABASE_KEY);

      // Get modal elements
      const contactModal = document.getElementById('contact-modal');
      const modalCloseButton = document.querySelector('.close-button');
      const contactForm = document.getElementById('contact-form');
      const fileInput = document.getElementById('attachments');
      const selectedFilesContainer = document.getElementById('selected-files');

      // Show modal after a short delay when page loads
      setTimeout(() => {
          contactModal.classList.add('show');
      }, 2000);

      // Handle file selection
      fileInput.addEventListener('change', () => {
          selectedFilesContainer.innerHTML = '';
          Array.from(fileInput.files).forEach(file => {
              const fileElement = document.createElement('div');
              fileElement.className = 'selected-file';
              fileElement.innerHTML = `
                  <span>${file.name}</span>
                  <div class="upload-progress">
                      <div class="upload-progress-bar" style="width: 0%"></div>
                  </div>
              `;
              selectedFilesContainer.appendChild(fileElement);
          });
      });

      // Close modal when clicking close button or outside
      modalCloseButton.addEventListener('click', () => {
          contactModal.classList.remove('show');
          setTimeout(() => {
              contactModal.style.display = 'none';
          }, 300);
      });

      window.addEventListener('click', (e) => {
          if (e.target === contactModal) {
              contactModal.classList.remove('show');
              setTimeout(() => {
                  contactModal.style.display = 'none';
              }, 300);
          }
      });

      // Handle form submission
      contactForm.addEventListener('submit', async (e) => {
          e.preventDefault();

          const submitButton = contactForm.querySelector('.submit-btn');
          submitButton.disabled = true;
          submitButton.textContent = 'Submitting...';

          try {
              const files = fileInput.files;
              const uploadedUrls = [];

              // Upload files if any are selected
              if (files.length > 0) {
                  for (let i = 0; i < files.length; i++) {
                      const file = files[i];
                      const fileExt = file.name.split('.').pop();
                      const timestamp = new Date().getTime();
                      const fileName = `${timestamp}_${file.name}`;
                      const filePath = `attachments/${fileName}`;

                      // Get the progress bar for this file
                      const progressBar = selectedFilesContainer.children[i].querySelector('.upload-progress-bar');

                      try {
                          // Upload file to Supabase Storage
                          const { data: uploadData, error: uploadError } = await contactFormSupabase.storage
                              .from('quote-attachments')
                              .upload(filePath, file, {
                                  cacheControl: '3600',
                                  upsert: false
                              });

                          if (uploadError) {
                              console.error('Upload error:', uploadError);
                              throw uploadError;
                          }

                          // Update progress bar to show completion
                          progressBar.style.width = '100%';

                          // Get public URL for the uploaded file
                          const { data: { publicUrl } } = contactFormSupabase.storage
                              .from('quote-attachments')
                              .getPublicUrl(filePath);

                          uploadedUrls.push(publicUrl);
                      } catch (uploadError) {
                          console.error('Error uploading file:', uploadError);
                          alert(`Error uploading file ${file.name}. Please try again.`);
                          return;
                      }
                  }
              }

              // Prepare form data with attachments
              const formData = {
                  name: document.getElementById('name').value,
                  email: document.getElementById('email').value,
                  cell_number: document.getElementById('cell_number').value,
                  message: document.getElementById('message').value,
                  created_at: new Date().toISOString(),
                  attachment_url: uploadedUrls[0] || null,
                  attachment_urls: uploadedUrls
              };

              console.log('Submitting form data:', formData);

              try {
                  // Insert data into customers table
                  const { data, error } = await contactFormSupabase
                      .from('customers')
                      .insert([formData]);

                  if (error) {
                      console.error('Database error:', error);
                      throw error;
                  }

                  // Show success message and close modal
                  alert('Thank you for your message! We will get back to you soon.');
                  contactModal.classList.remove('show');
                  setTimeout(() => {
                      contactModal.style.display = 'none';
                  }, 300);
                  
                  // Reset form and clear file list
                  contactForm.reset();
                  selectedFilesContainer.innerHTML = '';
              } catch (error) {
                  console.error('Error submitting form:', error);
                  alert('There was an error submitting your message. Please try again.');
              } finally {
                  submitButton.disabled = false;
                  submitButton.textContent = 'Submit';
              }
          } catch (error) {
              console.error('Error:', error);
              alert('There was an error submitting your message. Please try again.');
          } finally {
              submitButton.disabled = false;
              submitButton.textContent = 'Submit';
          }
      });
  </script>
</body>

<!-- Scroll animation script -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Add scroll-fade-in class to elements we want to animate on scroll
    const elementsToAnimate = [
      '.category-container',
      '.benefit-card',
      '#contact .container > div',
      '.section-title',
      '.section-subtitle'
    ];
    
    // Apply the scroll-fade-in class to all matching elements
    elementsToAnimate.forEach(selector => {
      document.querySelectorAll(selector).forEach(element => {
        element.classList.add('scroll-fade-in');
      });
    });
    
    // Function to check if an element is in viewport
    function isInViewport(element) {
      const rect = element.getBoundingClientRect();
      return (
        rect.top <= (window.innerHeight || document.documentElement.clientHeight) * 0.85 &&
        rect.bottom >= 0
      );
    }
    
    // Function to handle scroll events and trigger animations
    function handleScroll() {
      document.querySelectorAll('.scroll-fade-in').forEach(element => {
        if (isInViewport(element) && !element.classList.contains('visible')) {
          element.classList.add('visible');
        }
      });
    }
    
    // Initial check on page load
    handleScroll();
    
    // Listen for scroll events
    window.addEventListener('scroll', handleScroll);
  });
</script>
</html>